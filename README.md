# dharmamitra-frontend-next

Dharmamitra frontend v2 â€” a [Next.js](https://nextjs.org/) project bootstrapped with [`create-next-app`](https://github.com/vercel/next.js/tree/canary/packages/create-next-app).

## Getting Started

First, run the development server:

```bash
yarn dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the home page generated by `src/app/page.tsx`.

This project uses:

- [`next/font`](https://nextjs.org/docs/basic-features/font-optimization) to automatically optimize and load Inter, a custom Google Font.
- [`next-intl`](https://next-intl-docs.vercel.app/docs) ([examples](https://github.com/amannn/next-intl/tree/main/examples)).
    - [Unicode Common Locale Data Repository (CLDR)](https://cldr.unicode.org/index/charts) local codes used by [Javascripts's Internationalization API](https://tc39.es/ecma402/#sec-implementation-dependencies) are used for `/messages/` files.
    - `/messages/` files use the convention of title-case keys for page content and camel-case keys for component content. 
- [`Material UI`](https://mui.com/material-ui/getting-started/) with [Next.js App routing integration](https://mui.com/material-ui/integrations/nextjs/)
- [linting tools](https://medium.com/yavar/setting-up-a-eslint-prettier-husky-and-lint-staged-integration-with-typescript-in-next-js-13-14-68044dfae920#ec5e) (`eslint`, `prettier`, `simple-import-sort`, `husky`, and `lint-staged`)
    - [`husky`](https://typicode.github.io/husky/) uses v9 config
    - for code reliability `husky` runs a `pre-push` hook that tests if the project successfully builds
    - all git hooks can be skipped by adding a `-n/--no-verify` option.
- [`playwrite`](https://playwright.dev/docs/intro) and [`@axe-core/playwright`](https://www.npmjs.com/package/@axe-core/playwright)

### Next.js

To learn more about Next.js, take a look at the following resources:

- [Next.js Documentation](https://nextjs.org/docs) - learn about Next.js features and API.
- [Learn Next.js](https://nextjs.org/learn) - an interactive Next.js tutorial.

You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js/) - your feedback and contributions are welcome!

## Containerization

### Simple setting

```sh
docker build . --tag dmnext  --no-cache
docker run --detach --rm --publish 3333:3000 --name dmnext dmnext
```

`3000` is the default port for Next.js apps so here we publish it on local port `3333` to avoid port conflics with other locally deployed apps (i.e. BN).

The project will be available at `http://localhost:3333/dmnext`. To shut it down gracefully run:

```sh
docker stop dmnext
```

### Compose setting

```
docker compose build --no-cache && docker compose up --force-recreate -d
```

NGINX is added to the docker-compose setting so that the environment is more production-like with a webserver in front of the app.
The app is again available under `localhost:3333` e.g. `http://localhost:3333/dmnext/bo/about`.

The server (published locally on port 80) functions as a proxy so the same page should be reachable over `http://localhost/dmnext/bo/about`

If you want to see the NGINX logs you can use (press Ctrl-C to exit):

```
docker logs nginx -f
```


## Testing

Playwright commands:

```sh
# Run the end-to-end tests.
yarn playwright test

# Starts the interactive UI mode.
yarn playwright test --ui

# Runs the tests only on Desktop Chrome.
yarn playwright test --project=chromium
 
# Runs the tests in a specific file.
yarn playwright test example

# Runs the tests in debug mode.
yarn playwright test --debug

# Auto generate tests with Codegen.
yarn playwright codegen
```    

Visit https://playwright.dev/docs/intro for more information